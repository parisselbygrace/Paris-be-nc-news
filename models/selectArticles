const db = require(`../db/connection`);
const {checkArticleExists} = require ('../db/db.js')


exports.selectArticles = () => {
  return db
    .query(
      `
          SELECT articles.author, title, articles.article_id,
              topic, articles.created_at, articles.votes,
              COUNT(comments.body) AS comment_count
              FROM articles
              LEFT JOIN comments ON articles.article_id = comments.article_id
              GROUP BY articles.article_id
              ORDER BY articles.created_at DESC;
      `
    )
    .then((result) => {
      return result.rows;
    });
};

exports.selectArticleById = (article_id) => {
    console.log('Hi')
    return checkArticleExists(article_id).then(() => {
    return db.query(`SELECT *
            FROM articles
            WHERE articles.article_id = $1
            `,
            [article_id]).then((article)=>{
    console.log(article.rows[0])
        return article.rows[0]})
    })
    }

